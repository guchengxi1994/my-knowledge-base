# 简介

​		Dart是谷歌开发的计算机编程语言，后来被Ecma ([ECMA-408](https://www.ecma-international.org/wp-content/uploads/ECMA-408_4th_edition_december_2015.pdf))认定为标准。它被用于web、服务器、移动应用和物联网等领域的开发。

​		Dart亮相于2011年10月10日至12日在丹麦奥尔胡斯举行的GOTO大会上。该项目由[Lars bak](https://en.wikipedia.org/wiki/Lars_Bak_(computer_programmer))(这个人2017年离开了谷歌，然后2018年dart2就变成了强类型语言了😀)和kasper lund创建。

​		*说句题外话，为什么flutter官方语言选择了dart而不是其它在当时更加优秀的语言，据说是因为谷歌这两个部门之间离得很近，沟通起来方便。*

# dart基础

## 1. 新建项目

​		和flutter一样，dart的项目也需要一个名叫`pubspec.yaml`的文件。同时，这个文件必须包含两个属性，`name`和`environment`，name是项目名，environment是项目所用的sdk版本，例如：

```yaml
name: dart_sample

environment:
  sdk: '>=2.16.2 <3.0.0'
```

> 其它属性例如`author`(已弃用)、`homepage`、`version`、`introduction`、`dependencies`和`dev_dependencies`等可以视情况添加。

​		添加完成这个文件之后，一般需要再加一个`gitignore`文件，这里推荐[gitignore](https://github.com/github/gitignore)这个仓库，可以从里面找到几乎所有语言对应的gitignore文件。

​		然后就可以开始写代码了，一般来说会有一个`lib`文件夹，所写的代码都放在这个lib文件夹下，最终项目结构如下：

```
│   .gitignore
│   .packages
│   pubspec.lock
│   pubspec.yaml
│
├───.dart_tool
│       package_config.json
│
└───lib
        main.dart
```

​		在`main.dart`里写入一段测试代码，

```dart
void main() {
  print("hello world");
}
```

执行`dart run .\lib\main.dart`即可看到控制台打印 “hello world”。

## 2. 包管理

### 2.1 pub.dev

​		`dart`和`flutter`有一个包管理平台 pub.dev，但是国内访问受限，所以一般都是用镜像网址 [pub.flutter-io.cn](https://pub.flutter-io.cn/) 。

> 如果没有工具，可能需要换国内源才能正常下载dart或者flutter的包。
>
> ```shell
> export PUB_HOSTED_URL=https://pub.flutter-io.cn
> export FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn
> ```
>
> windows用户直接设置环境变量。

### 2.2 在项目中添加依赖

​		比如，我们要在项目中添加第三方的包`ini`(一个读取ini文件的工具)，有两种方案。

* 命令行添加

  > ```shell
  > dart pub add ini
  > ```

  然后在`pubspec.yaml` 文件中就出现了新内容

  ```yaml
  dependencies: {ini: ^2.1.0}     
  ```

  由于是唯一一个依赖，所以依赖写在了一行之内，我们一般的写法是这样的：

  ```yaml
  dependencies:
  	ini: ^2.1.0
  ```

  `^`代表的是大于或等于2.1.0版本的所有小版本（即2.1.*版本），当然也可以指定版本，只要去掉前面的`^`即可。

  > 但是项目真正的包管理是通过另一个文件`pubspec.lock`完成的，这个文件中才会真正指定版本号，例如当前项目的依赖就是这样的：
  >
  > ```
  > # Generated by pub
  > # See https://dart.dev/tools/pub/glossary#lockfile
  > packages:
  >   ini:
  >     dependency: "direct main"
  >     description:
  >       name: ini
  >       url: "https://pub.flutter-io.cn"
  >     source: hosted
  >     version: "2.1.0"
  > sdks:
  >   dart: ">=2.16.2 <3.0.0"
  > ```
  >
  > 这里指定了`ini`包的版本为2.1.0。
  >
  > > 所以，如果自己开发相关的dart或者flutter项目，想作为第三方包给他人使用，在版本控制的时候，尽量保证小版本号的函数调用方式一致（函数名一致，入参，返回值，异步等），否则容易在升级之后造成异常。

* 直接修改`pubspec.yaml`文件

​		这个比较简单，直接修改文件之后 `vscode`的dart/flutter插件就会直接下载对应的依赖。 



